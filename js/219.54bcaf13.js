"use strict";(self["webpackChunkact"]=self["webpackChunkact"]||[]).push([[219],{4219:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"operation"},[e._v(" 日期： "),t("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.query.time,callback:function(t){e.$set(e.query,"time",t)},expression:"query.time"}}),e._v(" 活动名称："),t("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.query.activityName,callback:function(t){e.$set(e.query,"activityName",t)},expression:"query.activityName"}}),e._v(" 部门："),t("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.query.depName,callback:function(t){e.$set(e.query,"depName",t)},expression:"query.depName"}}),e._v(" 姓名"),t("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.query.trueName,callback:function(t){e.$set(e.query,"trueName",t)},expression:"query.trueName"}}),t("el-button",{attrs:{type:"success",icon:"el-icon-search",circle:""},on:{click:e.getList}}),t("el-button",{attrs:{type:"primary"},on:{click:e.exportAsExcel}},[e._v("导出")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"ATable",attrs:{data:e.tableData,border:!0,stripe:""}},[t("el-table-column",{attrs:{prop:"activityName",label:"活动名称"}}),t("el-table-column",{attrs:{prop:"depName",label:"部门"}}),t("el-table-column",{attrs:{prop:"trueName",label:"姓名"}}),t("el-table-column",{attrs:{prop:"isSignOut",label:"签退状态"}}),t("el-table-column",{attrs:{prop:"signInTime",label:"签到时间"}}),t("el-table-column",{attrs:{prop:"signOutTime",label:"签退时间"}})],1),t("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":e.pagination.current,"page-sizes":e.pagination.pageSizes,"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},n=[],r=a(178);function s(e=1,t=10,a){const i=new FormData;return i.append("activityName",a.activityName),i.append("trueName",a.trueName),i.append("depName",a.depName),i.append("signStartTime",a.signStartTime),i.append("signEndTime",a.signEndTime),(0,r.Z)({url:`/signIn/signInList/${e}/${t}`,method:"post",data:i})}function l(e){const t=new FormData;return t.append("activityName",e.activityName),t.append("trueName",e.trueName),t.append("depName",e.depName),(0,r.Z)({url:"/signIn/export",method:"post",data:t,responseType:"blob"})}var o=a(6797),c=a.n(o),p={name:"SignView",data(){return{tableData:[],dialogFormVisible:!1,query:{activityName:"",trueName:"",depName:"",time:""},loading:!0,pickerOptions:{shortcuts:[{text:"最近一周",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},pagination:{current:1,pageSizes:[10,20,50],pageSize:10,total:0}}},created(){this.query.activityName=this.$store.state.activityName,this.getList()},methods:{async getList(){const e={activityName:this.query.activityName,trueName:this.query.trueName,depName:this.query.depName,signStartTime:this.query.time?c()(this.query.time[0]).format("YYYY-MM-DD HH:mm:ss"):"",signEndTime:this.query.time?c()(this.query.time[1]).format("YYYY-MM-DD HH:mm:ss"):""};this.loading=!0;const{data:{data:t}}=await s(this.pagination.current,this.pagination.pageSize,e);t.records.forEach((e=>{e.isSignOut=e.isSignOut?"已签退":"未签退",e.signInTime=e.signInTime?c()(e.signInTime).format("YYYY-MM-DD HH:mm:ss"):"未签到",e.signOutTime=e.signOutTime?c()(e.signOutTime).format("YYYY-MM-DD HH:mm:ss"):"未签退"})),this.pagination.current=t.current,this.pagination.total=t.total,this.tableData=t.records,this.loading=!1},handleSizeChange(e){this.pagination.pageSize=e,this.getList()},handleCurrentChange(e){this.pagination.current=e,this.getList()},async exportAsExcel(){const{data:e}=await l(this.query),t=window.URL.createObjectURL(new Blob([e])),a=document.createElement("a");a.style.display="none",a.href=t,a.download="签到信息表.xlsx",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(a.href),document.body.removeChild(a),this.$message.success("导出成功",1)}}},m=p,u=a(3736),d=(0,u.Z)(m,i,n,!1,null,"a12b23ec",null),g=d.exports}}]);
//# sourceMappingURL=219.54bcaf13.js.map